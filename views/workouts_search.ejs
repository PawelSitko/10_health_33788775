<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Search workouts â€“ Health Tracker</title>
    <link rel="stylesheet" href="/style.css">
  </head>

  <body>
    <main class="page">
      <section class="card">
        <header class="card-header">
          <h1>Search workouts</h1>

          <nav class="nav-links">
            <a href="/">ğŸ  Home</a>
            <a href="/users/login">ğŸ”‘ Login</a>
            <a href="/users/register">ğŸ“ Register</a>
            <a href="/workouts/list">ğŸ¶ Workouts</a>
          </nav>
        </header>

        <section class="card-body">
          <% if (user) { %>
            <p>Searching workouts for <strong><%= user.username %></strong>.</p>
          <% } %>

          <form method="GET" action="/workouts/search" class="search-form">
            <div class="form-row">
              <label>Search by activity</label>
              <input
                type="text"
                name="q"
                placeholder="e.g. run, gym, swim"
                value="<%= query || '' %>"
              />
            </div>
            <button type="submit" class="btn">Search</button>
            <a class="btn secondary" href="/workouts/list">Back to list</a>
          </form>

          <% if (error) { %>
            <p class="error"><%= error %></p>
          <% } %>

          <% if (typeof query !== 'undefined' && query !== '' && workouts && workouts.length === 0) { %>
            <p>No workouts matched "<%= query %>".</p>
          <% } %>

          <% if (workouts && workouts.length > 0) { %>
            <h2>Results</h2>
            <table class="workouts-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Activity</th>
                  <th>Duration</th>
                  <th>Intensity</th>
                  <th>Notes</th>
                  <th></th>
                </tr>
              </thead>
              <tbody>
                <% workouts.forEach(function(w) { %>
                  <tr>
                    <td><%= w.date ? (w.date.toISOString ? w.date.toISOString().slice(0,10) : w.date) : '' %></td>
                    <td><%= w.activity || '' %></td>
                    <td><%= w.duration || '' %></td>
                    <td><%= w.intensity || '' %></td>
                    <td><%= w.notes || '' %></td>
                    <td>
                      <a href="/workouts/edit/<%= w.id %>">Edit</a>
                    </td>
                  </tr>
                <% }) %>
              </tbody>
            </table>
          <% } %>
        </section>
      </section>
    </main>
  </body>
</html>
